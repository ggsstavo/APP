<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Configurações de Conta</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="icon" type="image/png" href="../favicon/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="../favicon/favicon.svg" />
<link rel="shortcut icon" href="../favicon/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="../favicon/apple-touch-icon.png" />
<link rel="manifest" href="../favicon/site.webmanifest" />

  <!-- Firebase v9 modular -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
    import {
      getAuth,
      onAuthStateChanged,
      updateEmail,
      updatePassword,
      signOut,
      signInWithEmailAndPassword
    } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDtnzixicBYAQkuoeB5tgCGpDLt1lByMZo",
      authDomain: "apropriacao-estrutura.firebaseapp.com",
      projectId: "apropriacao-estrutura",
      storageBucket: "apropriacao-estrutura.appspot.com",
      messagingSenderId: "155266586257",
      appId: "1:155266586257:web:6d70edc967cdbfc56e5130",
    };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // --- Helpers ---
    function applySavedTheme() {
      const isDark = localStorage.getItem('dark') === '1';
      document.documentElement.classList.toggle('dark', isDark);
      document.querySelector(`#theme-${isDark ? 'dark' : 'light'}`).checked = true;
    }
    function handleThemeChange(e) {
      const isDark = e.target.value === 'dark';
      document.documentElement.classList.toggle('dark', isDark);
      localStorage.setItem('dark', isDark ? '1' : '0');
    }
    async function reauthenticate(email) {
      const pwd = prompt('Sessão expirada. Digite sua senha atual:');
      if (!pwd) throw new Error('Reautenticação cancelada');
      await signInWithEmailAndPassword(auth, email, pwd);
    }

    document.addEventListener('DOMContentLoaded', () => {
      applySavedTheme();

      onAuthStateChanged(auth, async user => {
        if (!user) return window.location.href = '../index.html';
        document.querySelector('#email').value = user.email;
      });

      // Theme radios
      document.querySelectorAll('input[name="theme"]')
        .forEach(r => r.addEventListener('change', handleThemeChange));

      // Show/hide email & password
      document.querySelector('#show-email')
        .addEventListener('change', e => {
          document.querySelector('#email').type = e.target.checked ? 'text' : 'email';
        });
      document.querySelector('#show-pwd')
        .addEventListener('change', e => {
          document.querySelector('#password').type = e.target.checked ? 'text' : 'password';
        });

      // Update Email
      document.querySelector('#btn-email').addEventListener('click', async () => {
        const user = auth.currentUser;
        const newEmail = document.querySelector('#email').value.trim();
        try {
          await updateEmail(user, newEmail);
          alert('Email atualizado com sucesso!');
        } catch (err) {
          if (err.code === 'auth/requires-recent-login') {
            try {
              await reauthenticate(user.email);
              await updateEmail(user, newEmail);
              alert('Email atualizado após reautenticação!');
            } catch (reauthErr) {
              alert('Reautenticação falhou: ' + reauthErr.message);
            }
          } else {
            alert('Erro ao atualizar email: ' + err.message);
          }
        }
      });

      // Update Password
      document.querySelector('#btn-pwd').addEventListener('click', async () => {
        const user = auth.currentUser;
        const newPwd = document.querySelector('#password').value;
        if (newPwd.length < 6) {
          alert('A senha deve ter ao menos 6 caracteres.');
          return;
        }
        try {
          await updatePassword(user, newPwd);
          alert('Senha atualizada com sucesso!');
          document.querySelector('#password').value = '';
        } catch (err) {
          if (err.code === 'auth/requires-recent-login') {
            try {
              await reauthenticate(user.email);
              await updatePassword(user, newPwd);
              alert('Senha atualizada após reautenticação!');
              document.querySelector('#password').value = '';
            } catch (reauthErr) {
              alert('Reautenticação falhou: ' + reauthErr.message);
            }
          } else {
            alert('Erro ao atualizar senha: ' + err.message);
          }
        }
      });

      // Logout
      document.querySelector('#btn-logout')
        .addEventListener('click', async () => {
          await signOut(auth);
          window.location.href = '../index.html';
        });
    });

    // Menu hamburger
const toggleMenuBtn = document.getElementById("toggleMenu");
const menuList = document.getElementById("menuList");

toggleMenuBtn.addEventListener("click", () => {
  menuList.classList.toggle("active");
});
  </script>

  <style>
    :root {
      --bg: #fafafa;
      --card: #fff;
      --text: #333;
      --accent: #2c3e50;
      --soft: #e9ecef;
      --radio-size: 20px;
    }
    .dark {
      --bg: #06080c;
      --card: #090b16;
      --text: #e0e0e0;
      --accent: #2c6cd7;
      --soft: #3c3f68;
    }

    *, *::before, *::after { margin: 0;
      padding: 0;
      box-sizing: border-box; }
    body {
      display: flex;
    min-height: 100vh;
    font-family: 'Segoe UI', sans-serif;
    background: var(--bg);
    color: var(--text);
    transition: background .3s, color .3s;
    overflow-x: hidden;
    }

    body::before {
  content: "";
    position: absolute;
    top: 50%; left: 50%;
    width: 200vw; height: 200vh;
    transform: translate(-50%, -50%);
    background: radial-gradient(circle at center, rgba(92,124,250,0.15), transparent 60%);
    filter: blur(40px);
    opacity: 1;
    pointer-events: none;
    z-index: -1;
    will-change: opacity;
    transition: opacity .4s ease, background .4s ease;
}

/* Tema escuro: brilho mais visível e adaptado */
.dark body::before {
  background: radial-gradient(circle at center, rgba(44,108,215,0.2), transparent 70%);
    filter: blur(60px);
    opacity: .8;
}

.sidebar {
  font-family: Arial, sans-serif;
      width: 220px;
      background: #2c3e50;
      color: #fff;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }
    .sidebar-header {
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    .hamburger {
      display: none;
      background: none;
      border: none;
      color: #fff;
      font-size: 24px;
      position: absolute;
      left: 0;
      cursor: pointer;
    }
    .logo {
      font-size: 24px;
      user-select: none;
    }
    nav ul {
      list-style: none;
      margin-top: 20px;
    }
    nav ul li {
      margin: 15px 0;
    }
    nav ul li a {
      text-decoration: none;
      color: #fff;
      display: flex;
      align-items: center;
      padding: 10px;
      border-radius: 4px;
      transition: background 0.2s;
    }
    nav ul li a i {
      margin-right: 10px;
    }
    nav ul li a.active,
    nav ul li a:hover {
      background: #34495e;
    }
    .main-content {
      flex: 1;
      padding: 30px;
    }
    header h2 {
      margin-bottom: 20px;
      color: #2c3e50;
    }
    .settings {
      max-width: 600px;
      margin: 40px auto;
      padding: 32px;
      background: var(--card);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      animation: fadeInUp .6s ease-out both;
      position: relative;
  isolation: isolate;
  overflow: hidden;
  z-index: 1;
    }

    @media (max-width: 768px) {
  body {
    flex-direction: column;
  }

  body::before {
    display: none !important;
      filter: none !important;
      opacity: 0 !important;
    }
    .dark .sidebar {
      border-right: none !important;
      border-bottom: 1px solid var(--soft);
    }
  .sidebar {
    width: 100%;
    padding: 15px;
    flex-direction: column; /* <--- mudou de row para column */
    align-items: center;
    justify-content: flex-start;
  }

  .sidebar-header {
    width: 100%;
    justify-content: center;
    position: relative;
  }

  .hamburger {
    display: block;
    position: absolute;
    left: 15px;
    top: 50%;
    transform: translateY(-50%);
  }

  .logo {
    font-size: 20px;
    text-align: center;
    width: 100%;
  }

  nav ul {
    width: 100%;
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    transform-origin: top center;
    transform: translateY(-10px);
    transition: max-height 0.4s ease, opacity 0.4s ease, transform 0.4s ease;
    margin-top: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  nav ul.active {
    max-height: 650px;
    opacity: 1;
    transform: translateY(0);
  }

  .main-content {
    padding: 15px;
  }

  .settings h1{
    font-size: 1.8rem;
  }

  :not(.dark) .settings::before {
    background: radial-gradient(circle, rgba(200,200,200,0.4), transparent 70%);
      filter: blur(50px);
  }

  .settings::before {
    content: "";
    position: absolute;
    top: 50%; left: 50%;
    width: 160%; height: 160%;
    transform: translate(-50%, -50%);
    background: radial-gradient(circle, rgba(92,124,250,0.3), transparent 70%);
    filter: blur(50px);
    pointer-events: none;
    z-index: -1;
    will-change: opacity;
    transition: opacity .3s ease, background .3s ease;
    overflow-x: hidden;
  }

  .dark .settings::before {
    background: radial-gradient(circle, rgba(44,108,215,0.4), transparent 75%);
    filter: blur(65px);
    opacity: 0.95;
  }
}


    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .settings h1 { text-align: center; margin-bottom: 24px; }

    .section { margin-bottom: 24px; }
    .section label.title {
      display: block;
      margin-bottom: 8px;
      font-size: 1.1em;
      font-weight: 500;
    }
    input[type="email"],
    input[type="password"],
    select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--soft);
      border-radius: 6px;
      background: var(--bg);
      color: var(--text);
      transition: border .2s, box-shadow .2s;
    }
    input:focus, select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(92,124,250, .2);
      outline: none;
    }

    /* Tema radios */
    .radio-group {
      display: flex;
      gap: 16px;
    }
    .radio-group input {
      position: absolute;
      opacity: 0;
    }
    .radio-group label {
      display: flex;
      align-items: center;
      cursor: pointer;
      padding: 6px 12px;
      border: 1px solid var(--soft);
      border-radius: 6px;
      transition: background .2s, border-color .2s;
    }
    .radio-group label::before {
      content: "";
      display: inline-block;
      width: var(--radio-size);
      height: var(--radio-size);
      margin-right: 8px;
      border: 2px solid var(--accent);
      border-radius: 50%;
      transition: background .2s, transform .2s;
    }
    .radio-group input:checked + label {
      background: rgba(92,124,250, .1);
      border-color: var(--accent);
    }
    .radio-group input:checked + label::before {
      background: var(--accent);
      transform: scale(.8);
    }

    /* Toggles individuais */
    .radio-single {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 12px;
    }
    .radio-single input {
      position: absolute;
      opacity: 0;
    }
    .radio-single label {
      display: flex;
      align-items: center;
      cursor: pointer;
      padding: 6px 12px;
      border: 1px solid var(--soft);
      border-radius: 6px;
      transition: background .2s, border-color .2s;
      width: fit-content;
    }
    .radio-single label::before {
      content: "";
      display: inline-block;
      width: var(--radio-size);
      height: var(--radio-size);
      margin-right: 8px;
      border: 2px solid var(--accent);
      border-radius: 50%;
      transition: background .2s, transform .2s;
    }
    .radio-single input:checked + label {
      background: rgba(92,124,250, .1);
      border-color: var(--accent);
    }
    .radio-single input:checked + label::before {
      background: var(--accent);
      transform: scale(.8);
    }

    /* Sessões Ativas */
    #session-list {
      list-style: none;
      padding-left: 0;
    }
    #session-list li {
      padding: 6px 12px;
      border-bottom: 1px solid var(--soft);
    }

    /* Botões */
    .btn {
      width: 100%;
      padding: 12px;
      margin-top: 12px;
      border: none;
      border-radius: 6px;
      background: var(--accent);
      color: #fff;
      font-size: 1em;
      cursor: pointer;
      transition: transform .2s;
    }
    .btn:hover {
      transform: translateY(-2px);
    }
    .btn-logout {
      background: #e03131;
    }

    /* Estilo para “Sobre & Versão” */

.about-section {
  margin-top: 32px;
  padding: 16px 24px;
  background: var(--soft);
  border-radius: 8px;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: background .3s;
}

.about-section:hover {
  background: rgba(var(--accent-rgb,92,124,250), .1);
}

.about-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  text-align: center;
}

.version-info {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 1em;
  color: var(--text);
}

.version-info i {
  font-size: 1.2em;
  color: var(--accent);
  transition: transform .3s;
}

.about-section:hover .version-info i {
  transform: rotate(20deg);
}

.version-number {
  font-size: 0.9em;
  color: var(--text);
  opacity: .8;
  transition: color .2s;
}

.about-section:hover .version-number {
  color: var(--accent);
  opacity: 1;
}

.dark .sidebar {
  background: var(--card);       /* #090b16 */
  color: var(--text);            /* #e0e0e0 */
  border-right: 1px solid var(--soft); /* #3c3f68 como linha */  
} 

/* links e hover na sidebar em dark */
.dark .sidebar a {
  color: var(--text);
}
.dark .sidebar a:hover,
.dark .sidebar a.active {
  background: var(--soft);       /* #3c3f68 */
}

/* hamburger e ícones */
.dark .sidebar .hamburger,
.dark .sidebar .logo,
.dark .sidebar i {
  color: var(--text);
}
  </style>
</head>
<body>

  <div class="sidebar">
    <div class="sidebar-header">
      <button id="toggleMenu" class="hamburger">
        <i class="fas fa-bars"></i>
      </button>
      <h1 class="logo">Estrutura</h1>
    </div>
    <nav>
      <ul id="menuList">
  <li>
    <a href="#">
      <i class="fas fa-file-signature"></i> Apropriações
    </a>
  </li>
  <li>
    <a href="./equipes/equipe.html">
      <i class="fas fa-users-cog"></i> Equipes
    </a>
  </li>
  <li>
    <a href="./apontamentos/apontamentos.html">
      <i class="fas fa-clipboard-list"></i> Apontamentos
    </a>
  </li>
  <li>
    <a href="./diario/diario.html">
      <i class="fas fa-book"></i> Diário de obra
    </a>
  </li>
  <li>
    <a href="./efetivo/efetivo.html">
      <i class="fas fa-user-friends"></i> Efetivo
    </a>
  </li>
  <li>
    <a href="./anotar/anotar.html">
      <i class="fas fa-sticky-note" aria-hidden="true"></i> Anotações
    </a>
  </li>
  <li>
    <a href="#">
      <i class="fas fa-calendar-check"></i> Abono DSR
    </a>
  </li>
  <li>
  <a href="https://detroitbrasil.qforms.com.br/QuestionarioWeb/ResponderQuestionarioLink?chave=ADC929D335B064357179BDBAE1686855"
     target="_blank"
     rel="noopener noreferrer">
    <i class="fa-solid fa-shield-halved"></i> Observa+
  </a>
</li>
  <li>
    <a href="./configurações/configuracao.html" class="active">
      <i class="fas fa-cog"></i> Configurações
    </a>
  </li>
</ul>
    </nav>
  </div>
  <div class="main-content">
  <div class="settings">
    <h1>Configurações de Conta</h1>

    <!-- Tema -->
    <div class="section">
      <label class="title">Tema</label>
      <div class="radio-group">
        <input type="radio" name="theme" id="theme-light" value="light">
        <label for="theme-light">Claro</label>
        <input type="radio" name="theme" id="theme-dark" value="dark">
        <label for="theme-dark">Escuro</label>
      </div>
    </div>

    <!-- Email -->
    <div class="section">
      <label class="title" for="email">Email</label>
      <input type="email" id="email" readonly>
      <div class="radio-single">
        <input type="checkbox" id="show-email">
        <label for="show-email">Exibir Email</label>
      </div>
      <button class="btn" id="btn-email">Atualizar Email</button>
    </div>

    <!-- Senha -->
    <div class="section">
      <label class="title" for="password">Nova Senha</label>
      <input type="password" id="password" placeholder="••••••••">
      <div class="radio-single">
        <input type="checkbox" id="show-pwd">
        <label for="show-pwd">Exibir Senha</label>
      </div>
      <button class="btn" id="btn-pwd">Atualizar Senha</button>
    </div>

    <!-- Notificações -->
    <div class="section">
      <label class="title" for="notifications">Notificações</label>
      <select id="notifications">
        <option value="all">Todas</option>
        <option value="important">Apenas importantes</option>
        <option value="none">Nenhuma</option>
      </select>
    </div>

    <!-- Logout -->
    <button class="btn btn-logout" id="btn-logout"><i class="fa-solid fa-right-from-bracket" style="margin-right: 5px;"></i> Sair</button>
    <!-- Sobre & Versão -->
<div class="section about-section">
  <div class="about-content">
    <div class="version-info">
      <i class="fa-solid fa-circle-info"></i>
      <span>Versão do App</span>
    </div>
    <div class="version-number">v1.5</div>
  </div>
</div>
  </div>
  </div>
</body>
</html>
